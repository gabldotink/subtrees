HOMEPAGE="https://github.com/aous72/${PN}"
SRC_URI="https://github.com/aous72/${PN}/archive/refs/tags/${PV}.tar.gz"

CATEGORY="Libs"
SUMMARY="Open-source implementation of JPEG2000 Part-15 (or JPH or HTJ2K)"
DESCRIPTION="Open source implementation of High-throughput JPEG2000 (HTJ2K), also known as
JPH, JPEG2000 Part 15, ISO/IEC 15444-15, and ITU-T T.814. Here, we are
interested in implementing the HTJ2K only, supporting features that are
defined in JPEG2000 Part 1 (for example, for wavelet transform, only
reversible 5/3 and irreversible 9/7 are supported)."

LICENSE="BSD-2-Clause"
LICENSE_SPDX="SPDX-License-Identifier: BSD-2-Clause"
LICENSE_URI="license.md"

BUILD_REQUIRES="libtiff-devel"

inherit cmake

CYGCMAKE_ARGS="
	-DOJPH_BUILD_TEST:BOOL=ON
"

src_test()
{
	cd ${B}
	ninja_test
}

PKG_NAMES="
	OpenJPH
	libopenjph${PV[1]}.${PV[2]}
	libopenjph-devel
"
OpenJPH_CONTENTS="
	usr/bin/*.exe
	usr/share
"
libopenjph0_9_CONTENTS="
	usr/bin/*.dll
"
libopenjph_devel_CONTENTS="
	usr/include
	usr/lib
"
OpenJPH_SUMMARY="${SUMMARY} (utilities)"
libopenjph0_9_SUMMARY="${SUMMARY} (runtime)"
libopenjph_devel_SUMMARY="${SUMMARY} (development)"
