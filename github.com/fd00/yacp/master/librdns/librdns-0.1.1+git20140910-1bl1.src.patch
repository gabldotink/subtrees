--- origsrc/librdns/CMakeLists.txt	2014-09-20 23:20:56.000000000 +0900
+++ src/librdns/CMakeLists.txt	2014-09-20 23:57:26.148687500 +0900
@@ -49,22 +49,32 @@ IF(NOT SLAVE_BUILD)
 		ADD_DEFINITIONS("-DTWEETNACL")
 	ENDIF(ENABLE_CURVE MATCHES "ON")
 	
-		ADD_SUBDIRECTORY(contrib/libottery)
 	ADD_SUBDIRECTORY(test)
 	
 	ADD_LIBRARY(rdns_core OBJECT ${LIBRDNSSRC})
+
+	IF(NOT CYGWIN)
 	SET_TARGET_PROPERTIES(rdns_core PROPERTIES COMPILE_FLAGS "-fPIC")
+	ENDIF(NOT CYGWIN)
 	
-	SET(DLIBS "$<TARGET_OBJECTS:ottery>")
 	IF(ENABLE_CURVE MATCHES "ON")
 		LIST(APPEND DLIBS "$<TARGET_OBJECTS:tweetnacl>")
 	ENDIF(ENABLE_CURVE MATCHES "ON")
 	
+	IF(NOT CYGWIN)
 	ADD_LIBRARY(rdns_static STATIC $<TARGET_OBJECTS:rdns_core> ${DLIBS})
+	ENDIF(NOT CYGWIN)
 	ADD_LIBRARY(rdns SHARED $<TARGET_OBJECTS:rdns_core> ${DLIBS})
+	TARGET_LINK_LIBRARIES(rdns ottery)
 	SET_TARGET_PROPERTIES(rdns PROPERTIES
 			VERSION ${RDNS_VERSION_MAJOR}.${RDNS_VERSION_MINOR}.${RDNS_VERSION_PATCH}
 			SOVERSION ${RDNS_VERSION_MINOR})
+	INSTALL(TARGETS rdns
+		RUNTIME DESTINATION bin
+        	ARCHIVE DESTINATION lib)
+	FILE(GLOB headers "include/*.h")
+	INSTALL(FILES ${headers}
+	        DESTINATION include/rdns)
 ELSE(NOT SLAVE_BUILD)
 	ADD_LIBRARY(rdns STATIC ${LIBRDNSSRC})
 ENDIF(NOT SLAVE_BUILD)
