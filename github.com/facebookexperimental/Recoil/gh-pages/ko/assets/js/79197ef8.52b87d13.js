"use strict";(self.webpackChunkrecoil=self.webpackChunkrecoil||[]).push([[683],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,h=d["".concat(l,".").concat(m)]||d[m]||p[m]||o;return n?a.createElement(h,i(i({ref:t},u),{},{components:n})):a.createElement(h,i({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6170:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return u},default:function(){return d}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],s={title:"useRecoilTransaction_UNSTABLE(callback, deps)",sidebar_label:"useRecoilTransaction()"},l=void 0,c={unversionedId:"api-reference/core/useRecoilTransaction",id:"api-reference/core/useRecoilTransaction",title:"useRecoilTransaction_UNSTABLE(callback, deps)",description:'\uc548\uc804\ud558\uace0 \uc27d\uace0 \ud6a8\uc728\uc801\uc778 \ubc29\ubc95\uc73c\ub85c \ub2e4\uc218\uc758 atoms\ub97c \uc5c5\ub370\uc774\ud2b8\ud558\ub294 \ub370 \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 transaction callback\uc744 \ub9cc\ub4ed\ub2c8\ub2e4. \ub2e4\uc218\uc758 atoms\ub97c get() \ub610\ub294 set() \ud560 \uc218 \uc788\ub294 \uc21c\uc218 \ud568\uc218\ub85c transaction\uc5d0 \ub300\ud55c callback\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4. transaction\uc740 Recoil state setting\uc758 "updater" \ud615\ud0dc\uc640 \ube44\uc2b7\ud558\uc9c0\ub9cc, \ub2e4\uc218\uc758 atoms\uc5d0\uc11c \ub3d9\uc791\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.',source:"@site/i18n/ko/docusaurus-plugin-content-docs/current/api-reference/core/useRecoilTransaction.md",sourceDirName:"api-reference/core",slug:"/api-reference/core/useRecoilTransaction",permalink:"/ko/docs/api-reference/core/useRecoilTransaction",editUrl:"https://github.com/facebookexperimental/Recoil/edit/docs/docs/i18n/ko/docusaurus-plugin-content-docs/current/api-reference/core/useRecoilTransaction.md",tags:[],version:"current",frontMatter:{title:"useRecoilTransaction_UNSTABLE(callback, deps)",sidebar_label:"useRecoilTransaction()"},sidebar:"docs",previous:{title:"waitForAny()",permalink:"/ko/docs/api-reference/utils/waitForAny"},next:{title:"useRecoilCallback()",permalink:"/ko/docs/api-reference/core/useRecoilCallback"}},u=[{value:"Transaction Example",id:"transaction-example",children:[],level:3},{value:"Reducer Example",id:"reducer-example",children:[],level:3},{value:"Current Limitations and Future Vision",id:"current-limitations-and-future-vision",children:[],level:3}],p={toc:u};function d(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,'\uc548\uc804\ud558\uace0 \uc27d\uace0 \ud6a8\uc728\uc801\uc778 \ubc29\ubc95\uc73c\ub85c \ub2e4\uc218\uc758 atoms\ub97c \uc5c5\ub370\uc774\ud2b8\ud558\ub294 \ub370 \uc0ac\uc6a9\ud560 \uc218 \uc788\ub294 transaction callback\uc744 \ub9cc\ub4ed\ub2c8\ub2e4. \ub2e4\uc218\uc758 atoms\ub97c get() \ub610\ub294 set() \ud560 \uc218 \uc788\ub294 \uc21c\uc218 \ud568\uc218\ub85c transaction\uc5d0 \ub300\ud55c callback\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4. transaction\uc740 Recoil state setting\uc758 "updater" \ud615\ud0dc\uc640 \ube44\uc2b7\ud558\uc9c0\ub9cc, \ub2e4\uc218\uc758 atoms\uc5d0\uc11c \ub3d9\uc791\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.\n\ub3d9\uc77c\ud55c transaction \ub0b4\uc5d0\uc11c \uc4f0\uae30\ub294 \ub2e4\uc74c \uc77d\uae30\uc5d0\uc11c \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4.'),(0,o.kt)("p",null,"transactions \ubfd0\ub9cc \uc544\ub2c8\ub77c, \uc774 Hook\uc740 \ub2e4\uc74c\uacfc \uac19\uc740 \uacbd\uc6b0\uc5d0\ub3c4 \uc720\uc6a9\ud569\ub2c8\ub2e4:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"\ub2e4\uc218\uc758 atoms\uc5d0 \ub300\ud574\uc11c \ub3d9\uc791\uc744 \uc218\ud589\ud558\uae30 \uc704\ud55c reducer \ud328\ud134\uc744 \uad6c\ud604\ud569\ub2c8\ub2e4."),(0,o.kt)("li",{parentName:"ul"},"\ub80c\ub354\ub9c1 \uc2dc\uc810\uc5d0 \uc5b4\ub5a4 atom \ud639\uc740 selector\uac00 \uc5c5\ub370\uc774\ud2b8\ub97c \uc6d0\ud558\ub294\uc9c0 \ubaa8\ub974\ub294 atom \ud639\uc740 selector\ub97c \ub3d9\uc801\uc73c\ub85c \uc5c5\ub370\uc774\ud2b8\ud558\ubbc0\ub85c ",(0,o.kt)("a",{parentName:"li",href:"/docs/api-reference/core/useSetRecoilState"},(0,o.kt)("inlineCode",{parentName:"a"},"useSetRecoilState()")),"\ub294 \uc0ac\uc6a9\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4."),(0,o.kt)("li",{parentName:"ul"},"\ub80c\ub354\ub9c1 \uc804\uc5d0 \ub370\uc774\ud130\ub97c \ubbf8\ub9ac \uac00\uc838\uc635\ub2c8\ub2e4. ",(0,o.kt)("a",{parentName:"li",href:"/docs/guides/asynchronous-data-queries#pre-fetching"},"(Pre-fetching)"))),(0,o.kt)("hr",null),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"interface TransactionInterface {\n  get: <T>(RecoilValue<T>) => T;\n  set: <T>(RecoilState<T>,  (T => T) | T) => void;\n  reset: <T>(RecoilState<T>) => void;\n}\n\nfunction useRecoilTransaction_UNSTABLE<Args>(\n  callback: TransactionInterface => (...Args) => void,\n  deps?: $ReadOnlyArray<mixed>,\n): (...Args) => void\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"callback"))," - \ud2b8\ub79c\uc7ad\uc158 \uc778\ud130\ud398\uc774\uc2a4\ub97c \uc81c\uacf5\ud558\ub294 \ub798\ud37c \ud568\uc218\uac00 \uc788\ub294 \uc0ac\uc6a9\uc790 \ucf5c\ubc31 \ud568\uc218\uc785\ub2c8\ub2e4. ",(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("em",{parentName:"strong"},"\uc774 \uae30\ub2a5\uc740 \uc5b4\ub5a0\ud55c \uc0ac\uc774\ub4dc\uc774\ud399\ud2b8 \uc5c6\uc774 \uc21c\uc218\ud574\uc57c \ud569\ub2c8\ub2e4."))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"deps"))," - \ucf5c\ubc31\uc758 \uba54\ubaa8\uc774\uc81c\uc774\uc158\uc744 \uc704\ud55c \uc120\ud0dd\uc801 \ub514\ud39c\ub358\uc2dc \uc9d1\ud569\uc785\ub2c8\ub2e4.  ",(0,o.kt)("inlineCode",{parentName:"li"},"useCallback()"),"\uacfc \ub9c8\ucc2c\uac00\uc9c0\ub85c \uc0dd\uc131\ub41c \ud2b8\ub79c\uc7ad\uc158 \ucf5c\ubc31\uc740 \uae30\ubcf8\uc801\uc73c\ub85c \uba54\ubaa8\ub418\uc9c0 \uc54a\uc73c\uba70 \uac01 \ub80c\ub354\uc5d0\uc11c \uc0c8 \ud568\uc218\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.  \ube48 \ubc30\uc5f4\uc744 \uc804\ub2ec\ud558\uc5ec \ud56d\uc0c1 \ub3d9\uc77c\ud55c \ud568\uc218 \uc778\uc2a4\ud134\uc2a4\ub97c \ubc18\ud658\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.  ",(0,o.kt)("inlineCode",{parentName:"li"},"deps")," \ubc30\uc5f4\uc5d0 \uac12\uc744 \uc804\ub2ec\ud558\uba74,  dep\uc758 \ub4f1\uc2dd\uc774 \ubcc0\uacbd\ub418\uba74 \uc0c8 \ud568\uc218\uac00 \uc0ac\uc6a9\ub429\ub2c8\ub2e4.  T\uc774\ub7ec\ud55c \uac12\uc740 \ucf5c\ubc31 \ubcf8\ubb38 \ub0b4\uc5d0\uc11c \uc624\ub798\ub418\uc9c0 \uc54a\uace0 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. (See ",(0,o.kt)("a",{parentName:"li",href:"https://reactjs.org/docs/hooks-reference.html#usecallback"},(0,o.kt)("inlineCode",{parentName:"a"},"useCallback")),") ",(0,o.kt)("a",{parentName:"li",href:"/docs/introduction/installation#eslint"},"update eslint")," eslint\ub97c \uc5c5\ub370\uc774\ud2b8\ud558\uc5ec \uc62c\ubc14\ub974\uac8c \uc0ac\uc6a9\ud560 \uc218 \uc788\ub3c4\ub85d \ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.")),(0,o.kt)("p",null,"Transaction Interface:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"get"))," - \ud2b8\ub79c\uc7ad\uc158 \uc774\uc804\uc5d0 \uc218\ud589\ub41c \ubaa8\ub4e0 \uc4f0\uae30\ub97c \ubc18\uc601\ud558\uc5ec \uc694\uccad\ub41c Recoil \uc0c1\ud0dc\uc5d0 \ub300\ud55c \ud604\uc7ac \uac12\uc744 \uac00\uc838\uc635\ub2c8\ub2e4.  \uc774\uac83\uc740 \ud604\uc7ac \ub3d9\uae30 Atom\ub9cc \uc9c0\uc6d0\ud569\ub2c8\ub2e4."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"set"))," - Atom \uac12\uc744 \uc124\uc815\ud569\ub2c8\ub2e4.  \uc0c8 \uac12\uc744 \uc9c1\uc811 \uc81c\uacf5\ud558\uac70\ub098 \uc0c8 \uac12\uc744 \ubc18\ud658\ud558\uace0 \ud604\uc7ac \uac12\uc744 \ub9e4\uac1c \ubcc0\uc218\ub85c \uc0ac\uc6a9\ud558\ub294 \uc5c5\ub370\uc774\ud2b8 \ud504\ub85c\uadf8\ub7a8 \uae30\ub2a5\uc744 \uc81c\uacf5\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ud604\uc7ac \uac12\uc740 \ud604\uc7ac \ud2b8\ub79c\uc7ad\uc158\uc5d0\uc11c \ud604\uc7ac\uae4c\uc9c0 \ubcf4\ub958 \uc911\uc778 \ub2e4\ub978 \ubaa8\ub4e0 \uc0c1\ud0dc \ubcc0\uacbd\uc744 \ub098\ud0c0\ub0c5\ub2c8\ub2e4."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"strong"},"reset"))," - Atom \uac12\uc744 \uae30\ubcf8\uac12\uc73c\ub85c \uc7ac\uc124\uc815\ud569\ub2c8\ub2e4.")),(0,o.kt)("h3",{id:"transaction-example"},"Transaction Example"),(0,o.kt)("p",null,"Suppose we have two atoms, ",(0,o.kt)("inlineCode",{parentName:"p"},"positionState")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"headingState"),", and we'd like to update them together as part of a single action, where the new value of ",(0,o.kt)("inlineCode",{parentName:"p"},"positionState")," is a function of ",(0,o.kt)("em",{parentName:"p"},"both")," the current value of ",(0,o.kt)("inlineCode",{parentName:"p"},"positionState")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"headingState"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"const goForward = useRecoilTransaction_UNSTABLE(({get, set}) => (distance) => {\n  const heading = get(headingState);\n  const position = get(positionState);\n  set(positionState, {\n    x: position.x + cos(heading) * distance,\n    y: position.y + sin(heading) * distance,\n  });\n});\n")),(0,o.kt)("p",null,"Then you can execute the transaction by just calling ",(0,o.kt)("inlineCode",{parentName:"p"},"goForward(distance)")," in an event handler.  This will update state based on the ",(0,o.kt)("em",{parentName:"p"},"current")," values, not the state when the components rendered."),(0,o.kt)("p",null,"You can also read the values of previous writes during a transaction.  Because no other updates will be committed while the updater is executing, you will see a consistent store of state."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"const moveInAnL = useRecoilTransaction_UNSTABLE(({get, set}) => () => {\n  // Move Forward 1\n  const heading = get(headingState);\n  const position = get(positionState);\n  set(positionState, {\n    x: position.x + cos(heading),\n    y: position.y + sin(heading),\n  });\n\n  // Turn Right\n  set(headingState, heading => heading + 90);\n\n  // Move Forward 1\n  const newHeading = get(headingState);\n  const newPosition = get(positionState);\n  set(positionState, {\n    x: newPosition.x + cos(newHeading),\n    y: newPosition.y + sin(newHeading),\n  });\n});\n")),(0,o.kt)("h3",{id:"reducer-example"},"Reducer Example"),(0,o.kt)("p",null,"This hook is also useful for implementing reducer patterns to execute actions over multiple atoms:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"const reducer = useRecoilTransaction_UNSTABLE(({get, set}) => action => {\n  switch(action.type) {\n    case 'goForward':\n      const heading = get(headingState);\n      set(positionState, position => {\n        x: position.x + cos(heading) * action.distance,\n        y: position.y + sin(heading) * action.distance,\n      });\n      break;\n\n    case 'turn':\n      set(headingState, action.heading);\n      break;\n  }\n});\n")),(0,o.kt)("h3",{id:"current-limitations-and-future-vision"},"Current Limitations and Future Vision"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Transactions currently only support atoms, not yet selectors.  This support can be added in the future."),(0,o.kt)("li",{parentName:"ul"},"Atoms with default values that are selectors are also not yet supported."),(0,o.kt)("li",{parentName:"ul"},"Atoms that are read must have a synchronous value.  If it is in an error state or an asynchronous pending state, then the transaction will throw an error.  It would be possible to support pending dependencies by aborting the transaction if a dependency is pending and then re-starting the transaction when it is available.  This is consistent with how the selector ",(0,o.kt)("inlineCode",{parentName:"li"},"get()")," is implemented."),(0,o.kt)("li",{parentName:"ul"},"Transactions do not have a return value.  If we want to have some notification a transaction completes, or use transactions to request slow data, or to request data from event handlers, then we could have a transaction return a ",(0,o.kt)("inlineCode",{parentName:"li"},"Promise")," to a return value."),(0,o.kt)("li",{parentName:"ul"},"Transactions must be synchronous.  There is a proposal to allow asynchronous transactions.  The user could provide an ",(0,o.kt)("inlineCode",{parentName:"li"},"async")," transaction callback function which could use ",(0,o.kt)("inlineCode",{parentName:"li"},"await"),".  The atomic update of all sets would not be applied, however, until the ",(0,o.kt)("inlineCode",{parentName:"li"},"Promise")," returned by the transaction is fully resolved."),(0,o.kt)("li",{parentName:"ul"},"Transactions must not have any side-effects.  If you require side-effects, then use ",(0,o.kt)("a",{parentName:"li",href:"/docs/api-reference/core/useRecoilCallback"},(0,o.kt)("inlineCode",{parentName:"a"},"useRecoilCallback()"))," instead.")))}d.isMDXComponent=!0}}]);